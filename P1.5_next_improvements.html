<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html lang="en" xml:lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="content-type" content="application/xhtml+xml; charset=UTF-8" />
    <meta content="HTML Tidy for Windows (vers 1st November 2003), see www.w3.org" name="generator" />
    <title>Boost C++ Libraries</title>
    <link type="image/ico" href="http://www.boost.org/favicon.ico" rel="icon" />
    <link href="http://www.boost.org/style-v2/section-welcome.css" type="text/css" rel="stylesheet" />
    <link rel="stylesheet" type="text/css" href="files/code.css" />
    <!--[if IE 7]> <style type="text/css"> body { behavior: url(http://www.boost.org/style-v2/csshover3.htc); } </style> <![endif]-->
    <meta content="mpr2HgFpodnbF_8fv4qXd9roIClVwtX3C-Kd3F6r61w" name="google-site-verification" />
  </head>
  <!-- Note: Editing website content is documented at:http://www.boost.org/development/website_updating.html-->
  <!--***************************************************************************************** -->
  <!--                                        B O D Y                                           -->
  <!--***************************************************************************************** --> <body>
    <div id="heading">
      <div class="heading-inner">
        <h1 class="heading-title"> <a href="http://www.boost.org/"> <img class="heading-logo" alt="Boost C++ Libraries"
              src="http://www.boost.org//gfx/space.png" /> <span class="heading-boost">Boost</span> <span class="heading-cpplibraries">C++
              Libraries</span> <img style="width: 300px; height: 80px;" alt="Preliminary" src="img/preliminary.gif" />
          </a></h1>
        <p class="heading-quote"> <q>...one of the most highly regarded and expertly designed C++ library projects in
            the world.</q> <span class="heading-attribution">— <a class="external" href="http://www.gotw.ca/">Herb
              Sutter</a> and <a class="external" href="http://en.wikipedia.org/wiki/Andrei_Alexandrescu">Andrei
              Alexandrescu</a>, <a class="external" href="http://safari.awprofessional.com/?XmlId=0321113586">C++
              Coding Standards</a></span></p>
      </div>
    </div>
    <div class="clear"> </div>
    <div class="cuerpo_central"> <br />
      <div class="cuerpo_texto"> <br />
        <br />
        <span style="font-size: 24pt;"> <span style="font-weight: bold; color: black;"> <a href="index.html">The [
              Counter Tree + Suballocator ] Library</a> </span></span><br />
        <div>
          <div class="author">
            <h3 class="author"><br />
              <span class="firstname"></span></h3>
            <h3 class="author" style="font-size: 10pt; font-style: italic; font-weight: bold"> <span style="font-weight: bold;"><span
                  style="font-weight: bold;" class="firstname">Francisco Jose Tapia</span>   Copyright © 2010-2013
                Francisco Jose Tapia</span></h3>
          </div>
        </div>
        <div class="legalnotice">
          <p><span style="font-size: 10pt; font-style: italic; font-weight: bold">Distributed under the Boost Software
              License, Version 1.0. (See accompanying file LICENSE_1_0.txt or copy at <a target="_top" href="file:///LICENSE_1_0.txt">
                http://www.boost.org/LICENSE_1_0.txt )</a></span> </p>
        </div>
        <br />
        <br />
	  <!--***************************************************************************************** -->
	  <!--                                        M E N U                                           -->
	  <!--***************************************************************************************** --> 
        <div class="caja_menu"> <span style="font-size: 16pt; color: black;"><br />
            Table of Contents</span> <br />
          <div style="margin-left: 40px;">
            <div style="margin-left: 40px;"> <a href="P1.0_introduction.html#introduction">1.- Introduction</a><br />
              <div style="margin-left: 40px;"><a href="P1.0_introduction.html#countertree">1.1.- Description of the
                  Counter Trees</a><br />
                <div style="margin-left: 40px;"><a href="P1.0_introduction.html#iterators">1.1.1.- Iterators</a></div>
                <a href="P1.2_description_suballocators.html#suballocator">1.2.- Description of the Suballocators </a><br />
                <a href="P1.2_description_suballocators.html#countertree_suballocator">1.3.- Description of Counter
                  Trees + Suballocators </a><br />
                <a href="P1.4_concurrent_versions.html#concurrent">1.4.- Concurrent version</a><br />
                <a href="P1.5_next_improvements.html#next_improvements">1.5.- Next Improvements</a><br />
                <br />
              </div>
            </div>
          </div>
        </div>
        <br />
        <br />
        <p><a name="next_improvements"></a> <span style="font-size: 16pt;font-weight: bold; color: black;">1.5.- Next
            improvements</span></p>
        <p class="cuerpo_texto"> <br />
        </p>
        This is a long term project, designed in 6 stages, this version is the finish of the stage 3.<br />
        <br />
        The 6 stages are :<br />
        <br />
        <div style="margin-left: 40px;">
          <ol>
            <li>Design and implementation of the countertree</li>
            <li>Design and implementation of suballocator</li>
            <li>Concurrent version of countertree and suballocator</li>
            <li>Design and implementation of fast logic functions (union, intersection, nor intersection) with trees,,
              and design and implementation of several parallel functions of &lt;algorithms&gt;</li>
            <li>Redesign the internal algorithm used for the insertion, deletion and balancing, in order to improve the
              speed, provide support for the parallel algorithms of copy,insertion, union, intersection and not
              intersection with trees. It must provide support for the augmented trees.</li>
            <li> Augmented trees</li>
          </ol>
        </div>
        <br />
        A brief explanation of the stages 4 , 5 and 6<br />
        <br />
        <br />
        <span style="font-size: 14pt; color: black; ">4.- DESIGN AND IMPLEMENTATION OF FAST LOGIC FUNCTION. PARALLEL
          DESIGN OF FUNCTIONS OF &lt;ALGORITHM&gt;</span><br />
        <br />
        The need of fast logic function appear when I was reading about map-reduce systems. In the &lt;algorithms&gt;
        you have many of these functions. <br />
        <br />
        But many times you use the map as index of other information, and you have several index. As result of the
        search in the index you obtain a set of keys. You must combine the sets obtained, but the functions of
        &lt;algorithm&gt; create a new set with the result of the operations. If the set used as parameter are big, the
        result will be big too. And after obtain the result, destroy the parameters because don' need them. It is a
        waste of memory and time.<br />
        <br />
        My idea is to design the functions , but with the input passed with rvalues,the result  don't need create new
        elements, use the elements of the inputs. This permit reduce the memory needed, and improve the speed of the
        operation.<br />
        <br />
        Other idea is to include these functions in the classes set, multiset, map and multimap. If the parameter is a
        reference.  You can have versions with parameters references , and versions with parameters rvalues, which
        permit use the internal information of the parameter for to build the result.<br />
        <br />
        With the random access iterators of the countertree, it is easy to design parallel algorithms for many functions
        of &lt;algorithm&gt;, like for_each, count, count_if .......<br />
        <br />
        <br />
        <span style="font-size: 14pt; color: black; ">5.- REDESIGN OF THE INTERNAL ALGORITHM</span><br />
        <br />
        When you design a <span class="il">tree</span>, you must develop a balanced algorithm in order to prevent a
        degenerate <span class="il">tree</span> ( <span class="il">Tree</span> like a linked list). You have several
        types of balanced trees ( mainly Red-Black and <span>AVL</span> ).  That decision about the type of balance
        tree  have influence on the quality of the balance and the speed of the <span class="il">tree</span>. The most
        used are the red-black trees. You have an excellent description with code in <span style="font-style: italic;">“Introduction
          to Algorithms”</span> ( Cormen , Leiserson, Rivest). <br />
        <img align="middle" src="img/balanceo.png" alt="red-black balancing" style="border: 25px solid white;" />
        <p style="margin-bottom:0in">But , even the same type of balance tree, ,it  can be done in several ways,</p>
        <p style="margin-bottom:0in"><br />
        </p>
        <p style="margin-bottom:0in">In order to design an algorithm for to insert, delete and balance a red-black tree
          you must take care about</p>
        <p style="margin-bottom: 0in; margin-left: 40px;">1.- What of the solutions do you want </p>
        <div style="margin-left: 40px;"> </div>
        <p style="margin-bottom: 0in; margin-left: 40px;">2.- How do you define the rules, which applying obtain the
          desired solution.</p>
        <div style="margin-left: 40px;"> </div>
        <p style="margin-bottom: 0in; margin-left: 40px;">3.- What's the cost in time of process .</p>
        <div style="margin-left: 40px;"> </div>
        <p style="margin-bottom: 0in; margin-left: 40px;">4.- Benefits, advantage  of this solution respect the others </p>
        <p style="margin-bottom:0in"><br />
        </p>
        <br />
        <p style="margin-bottom:0in">When I decided add the <span class="il">counter</span> to the nodes for the design
          of the <span><span class="il">CounterTree</span></span>, I tried to use the code showed in "Introduction to
          algorithms", but was very complex the management of  the counters, and decide design my own balanced algorithm
          based on the 234Tree description. The result is the actual version of <span><span class="il">CounterTree</span></span>.
          It is 10% more or less slower than the <span>GCC</span> implementation, but is logic , because must manage
          the pointers and the counters.</p>
        <p style="margin-bottom:0in"><br />
        </p>
        It's only a first version. I am convinced, this algorithm can be improved in the design and in the
        implementation, Looking for a way for to improve the speed , I examined others implementations of Red-Black
        trees, several books an mainly with the experience obtained with the <span>Suballocator</span>. I decided to
        change several things of the algorithm and the implementation, pursuing to improve the speed. I have this design
        done on paper.<br />
        <br />
        The new version include operations for to :<br />
        <ul style="margin-left: 40px;">
          <li>Concatenate trees for the algorithm of copy parallel of a tree </li>
          <li>Insert a tree in the tree for the algorithm of parallel insertion in a tree</li>
          <li>Divide a big tree in a sequence of small sub-trees in order to be processed in the copy parallel algorithm</li>
          <li> Provide  a catalog of operations with the nodes. ( insert, delete , rotations, swap... ) in order to
            provide support to the augmented trees built inside the countertree.</li>
        </ul>
        <br />
        <br />
        <span style="font-size: 14pt; color: black;">6.-AUGMENTED TREES</span><br />
        <br />
        The augmented trees are trees with additional information, which is not fixed. It must be processed and changed
        when you insert, delete or move an node in the tree.<br />
        <br />
        This is very useful  for to maintain update the  statistical information of a set of data which is continuously
        changed. For to search inside a collection of ranges which are changing. For to maintains accumulators over a 
        values. The collection of problems which can be efficiently resolved with augmented trees is long.<br />
        <br />
        The countertrees are augmented trees. You have a counter in each node which represent the number of nudes under
        it. Every time you  insert, delete or move a  node in the tree, this information must be recalculate. <br />
        <br />
        The problem is the number of operations over the data structure. If you need obtain a statistical value over a
        collection of data, and need to obtain only a few times, many data structure can satisfy you requirements. The
        problem is when you need to do a lot of times, by example, you have intervals, and you need to detect the
        intersection between them in order to calculate a collision, in a particle simulation .<br />
        <br />
        For the speed the best solution is to include the information and the process inside the <span class="il">tree</span>.
        With this, you customize your <span class="il">tree</span> and obtain the maximum speed.<br />
        <br />
        In the new version of the algorithm, all the internal process of the <span class="il">tree</span> in a
        “catalog” of small operations like:<br />
        <br />
        <div style="margin-left: 40px;">
          <ul>
            <li>Insert/delete a node in the right/left pointer of a node.</li>
            <li>All the rotations with nodes</li>
            <li>Swap of nodes directly linked and not directly linked</li>
            <li>Design the information to insert in the node</li>
          </ul>
        </div>
        <br />
        If you design the process to do with your augmented information for all the operations of the catalog, you can
        create your augmented balanced <span class="il">tree</span> mixing the pointer and color operations with your
        code for each operation. <br />
        <br />
        You can have augmented trees with several concepts, like the position, accumulators and statistical operations
        as are defined in the Policy Based Data Structures and in the Boost Accumulator library. In the node operation
        you mix the pointers and color operations with the process of the catalog for all the augmented information
        added.<br />
        <br />
        The node operations have two parts, the pointers and the node color, and the augmented information. In the <span
          class="il">countertree</span> the first augmented information are the node counters. You can include several
        augmented informations in the same tree. You compile it, and then when the node need any operation, call their
        internal function, and after the functions of the augmented information of the tree.<br />
        <br />
        The solution exposed can be combined with the concurrent process and the suballocators,  which can improve a lot
        the speed of these accumulators, statistical operations or any other idea.</div>
      <br />
      <br />
      <a title="vector_tree" href="P2.0_vector_tree.html" style="float:right"><img alt="link to unordered page" src="img/next.png" /></a>
      <a title="introduction" href="P1.0_introduction.html" style="float:right"><img alt="go to head of the page" src="img/up.png" /></a>
      <a title="concurrent" href="P1.4_concurrent_versions.html" style="float:right"><img src="img/prev.png" alt="previous page" /></a>
      <a title="index.html" href="index.html" style="float:right"><img src="img/home.png" alt="home page" /></a> 
      <br />
      <table width="100%" xmlns:rev="http://www.cs.rpi.edu/~gregod/boost/tools/doc/revision">
        <tbody>
          <tr>
            <td align="left">
              <p><small>Last revised: September  30, 2012 at 21:42:41 GMT</small></p>
            </td>
            <td align="right"> <br />
            </td>
          </tr>
        </tbody>
      </table>
      <hr />
      <div id="footer">
        <div id="footer-left">
          <div id="copyright">
            <p>Copyright Francisco Jose Tapia 2010-2012.</p>
          </div>
          <div id="license">
            <p>Distributed under the <a class="internal" href="/LICENSE_1_0.txt">Boost Software License, Version 1.0</a>.</p>
          </div>
        </div>
        <div id="footer-right">
          <div id="banners">
            <p id="banner-xhtml"> <a class="external" href="http://validator.w3.org/check?uri=referer">XHTML 1.0</a></p>
            <p id="banner-css"> <a class="external" href="http://jigsaw.w3.org/css-validator/check/referer">CSS</a></p>
            <p id="banner-osi"> <a class="external" href="http://www.opensource.org/docs/definition.php">OSI Certified</a></p>
          </div>
        </div>
      </div>
    </div>
  </body>
</html>
